"use strict";(self.webpackChunkpactap_admin=self.webpackChunkpactap_admin||[]).push([[628],{91628:(D,u,r)=>{r.r(u),r.d(u,{NotificationModule:()=>w});var g=r(96814),h=r(6627),f=r(69862),l=r(16676),t=r(99468),b=r(57870),c=r(20553);let m=(()=>{class o{constructor(e){this.http=e,this.user=JSON.parse(localStorage.getItem("currentPactapAdmin"))}getUserLevel(){return this.http.get(`${c.N.apiUrl}notification/send/userlevel`)}getSentNotification(e){return this.http.get(`${c.N.apiUrl}notification/send?`,{params:e})}getRecivedNotification(e){return this.http.get(`${c.N.apiUrl}notification/recived?`,{params:e})}addNotification(e){return this.http.post(`${c.N.apiUrl}notification/send`,e)}deleteNotification(e){return this.http.delete(`${c.N.apiUrl}notification/send/${e}`)}markNotification(e){return this.http.patch(`${c.N.apiUrl}notification/recived/markasread`,e)}static#t=this.\u0275fac=function(i){return new(i||o)(t.LFG(f.eN))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var Z=r(45824),p=r(56223),v=r(60540);function N(o,d){if(1&o){const e=t.EpF();t.TgZ(0,"tr",47)(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td",48)(10,"div",49)(11,"div",50)(12,"button",51),t._UZ(13,"i",52),t.qZA(),t.TgZ(14,"ul",53)(15,"li")(16,"div",54),t.NdJ("click",function(){const s=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.markNotification(s._id))}),t._uU(17,"Mark as read"),t.qZA()()()()()()()}if(2&o){const e=d.$implicit,i=d.index,n=t.oxw();t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(null==e?null:e.title),t.xp6(2),t.Oqu(null==e?null:e.description),t.xp6(2),t.Oqu(n.getFormatedDate(null==e?null:e.dateOfNotification))}}function _(o,d){if(1&o){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td",48)(10,"div",55),t.NdJ("click",function(){const s=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.deleteNotification(s._id))}),t._UZ(11,"i",56),t.qZA()()()}if(2&o){const e=d.$implicit,i=d.index,n=t.oxw();t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(null==e?null:e.title),t.xp6(2),t.Oqu(null==e?null:e.description),t.xp6(2),t.Oqu(n.getFormatedDate(null==e?null:e.dateOfNotification))}}const T=[{path:"",component:(()=>{class o{constructor(e,i,n){this._US=e,this.notification=i,this.notifier=n,this.permissionsArr=[],this.notiPermission={read:!1,add:!1,update:!1,delete:!1},this.sentNotifications=[],this.recivedNotifications=[],this.dropdownList=[],this.selectedItems=[],this.dropdownSettings={},this.notificationTitle="",this.notificationDescription="",this.serachText="",this.serachText2="",this.selectedDate="",this.startDate="",this.endDate="",this.user=JSON.parse(localStorage.getItem("currentPactapAdmin"))}ngOnInit(){this.dropdownSettings={singleSelection:!1,idField:"value",textField:"label",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:3,allowSearchFilter:!0},this._US.getPermissions().subscribe(e=>{this.permissionsArr=e,Object.keys(this.notiPermission).map(i=>{this.canPerformAction("Notifications",i)})}),this.getUserProfile(),this.getSentNotification(),this.getRecivedNotification()}ngAfterViewInit(){setTimeout(()=>{this.initDateRangePicker()},200)}initDateRangePicker(){$(".daterangePickerQuote").dateRangePicker({format:"DD-MM-YYYY",autoClose:!0}).on("datepicker-change",(e,i)=>{console.log("change",i),this.startDate=l(i.date1).format("YYYY-MM-DD"),this.endDate=l(i.date2).format("YYYY-MM-DD"),this.getRecivedNotification()}),$(".daterangePickerNotify").dateRangePicker({format:"DD-MM-YYYY",autoClose:!0}).on("datepicker-change",(e,i)=>{console.log("change",i),this.startDate=l(i.date1).format("YYYY-MM-DD"),this.endDate=l(i.date2).format("YYYY-MM-DD"),this.getSentNotification()})}getUserProfile(){this.notification.getUserLevel().subscribe(e=>{this.dropdownList=e?.meta?.status?e.data:[]})}addQueryParams(){let e=new f.LE;return e=e.append("contentPerPage",10),e=e.append("page",1),this.serachText&&(e=e.append("searchTxt",this.serachText)),this.startDate&&this.endDate&&(e=e.append("fromDt",new Date(this.startDate).toString()),e=e.append("toDt",new Date(this.endDate).toString())),e}addQueryParams2(){let e=new f.LE;return e=e.append("contentPerPage",10),e=e.append("page",1),this.serachText2&&(e=e.append("searchTxt",this.serachText2)),this.startDate&&this.endDate&&(e=e.append("fromDt",new Date(this.startDate).toString()),e=e.append("toDt",new Date(this.endDate).toString())),e}getSentNotification(){this.notification.getSentNotification(this.addQueryParams()).subscribe(e=>{this.sentNotifications=e?.meta?.status?e.data:[]})}getRecivedNotification(){this.notification.getRecivedNotification(this.addQueryParams2()).subscribe(e=>{this.recivedNotifications=e?.meta?.status?e.data:[]})}getFormatedDate(e){return new Date(e).toLocaleDateString()}addNotification(){let e="";this.selectedItems?.forEach((i,n)=>{e+=i.value+(n===this.selectedItems.length-1?"":",")}),this.notification.addNotification({userLevel:e,title:this.notificationTitle,description:this.notificationDescription}).subscribe(i=>{document.getElementById("close-notification")?.click(),i?.meta?.status?(this.selectedItems=[],this.notificationTitle="",this.notificationDescription="",this.notifier.showSuccess(i?.meta.msg,""),this.getSentNotification()):this.notifier.showWarning(i?.meta.msg,"")})}deleteNotification(e){this.notification.deleteNotification(e).subscribe(i=>{i?.meta?.status?(this.notifier.showSuccess(i?.meta.msg,""),this.getSentNotification()):this.notifier.showWarning(i?.meta.msg,"")})}markNotification(e){this.notification.markNotification({id:e,isRead:!0}).subscribe(i=>{i?.meta?.status?(this.notifier.showSuccess(i?.meta.msg,""),this.getRecivedNotification()):this.notifier.showWarning(i?.meta.msg,"")})}canPerformAction(e,i){this.notiPermission[i]=this._US.hasPermission(e,i,this.permissionsArr)}openCalendar(e){e.stopPropagation(),$(".daterangePickerQuote").data("dateRangePicker").open()}openCalendarNotify(e){e.stopPropagation(),$(".daterangePickerNotify").data("dateRangePicker").open()}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(b.KD),t.Y36(m),t.Y36(Z.l))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-notifications"]],decls:108,vars:11,consts:[[1,"dashboardMain"],[1,"page-header"],[1,"account_dashboard","profile_dashboard"],[1,"nav","nav-pills","nav-justified","tabs-nav-automation"],[1,"nav-item"],["data-bs-toggle","tab","aria-current","page","href","#view",1,"nav-link","active"],["data-bs-toggle","tab","href","#add",1,"nav-link"],[1,"login-white-box","margin-automation-whitebox"],["id","myTabContent",1,"tab-content"],["id","view","role","tabpanel","aria-labelledby","home-tab",1,"tab-pane","fade","show","active"],[1,"row","justify-content-between","listFilter"],[1,"col-12","col-sm-8","col-md-10","col-lg-10"],[1,"row"],[1,"col-12","col-md-3","col-sm-6","col-lg-3"],[1,"form-group"],[1,"input-group"],["type","text","placeholder","Search","aria-label","Search","aria-describedby","basic-addon2",1,"form-control","border-0",3,"ngModel","ngModelChange"],[1,"input-group-append"],["type","button",1,"btn","searchBtn"],[1,"fa","fa-search"],[1,"col-12","col-md-7","col-lg-7","col-sm-6"],[1,"form-group","calendarInput"],["type","text","placeholder","EX: 12/02/2023  -  12/02/2023",1,"form-control","daterangePickerQuote"],[1,"formIconsinner",3,"click"],[1,"bi","bi-calendar-week"],[1,"table-responsive","fix-headertbl"],["width","100%","cellspacing","0",1,"table","table-bordered"],["class","text-success fw600",4,"ngFor","ngForOf"],["id","add","role","tabpanel","aria-labelledby","home-tab",1,"tab-pane","fade"],["type","text","placeholder","EX: 12/02/2023  -  12/02/2023",1,"form-control","daterangePickerNotify"],[1,"col-12","col-sm-4","col-md-2","col-lg-2","text-end"],["href","#","data-bs-toggle","modal","data-bs-target","#addNotificationModal",1,"btn","btn-success","btn-block"],[1,"bi","bi-plus-lg"],[4,"ngFor","ngForOf"],["id","addNotificationModal",1,"modal","fade"],[1,"modal-dialog","modal-lg","sample-popup-form"],[1,"modal-content"],[1,"modal-body"],[1,"form-box"],[1,"d-flex","justify-content-between","mb-3"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"form-control","form-ctrl",3,"placeholder","settings","data","ngModel","ngModelChange"],["type","text","placeholder","Title",1,"form-control","form-ctrl",3,"ngModel","ngModelChange"],["placeholder","Description",1,"form-control","form-ctrl",3,"ngModel","ngModelChange"],[1,"text-end","main_btn","mt-3"],["id","close-notification","data-bs-dismiss","modal",1,"btn","btn-light","me-3"],[1,"btn","btn-success",3,"disabled","click"],[1,"text-success","fw600"],[1,"text-end"],[1,"right-btns-dropdown"],[1,"dropdown","ms-2"],["type","button","id","dropdownMenuButton1","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-link","dropdown-toggle"],[1,"fa","fa-ellipsis-v"],["aria-labelledby","dropdownMenuButton1",1,"dropdown-menu","dropdown-menu-white","dropdownNew"],[1,"dropdown-item","pointer",3,"click"],[1,"text-success","underline-none","viewText","mr-1","pointer",3,"click"],[1,"fa","fa-trash-o"]],template:function(i,n){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h3"),t._uU(3,"Notifications"),t.qZA()(),t.TgZ(4,"div",2)(5,"ul",3)(6,"li",4)(7,"a",5),t._uU(8,"View"),t.qZA()(),t.TgZ(9,"li",4)(10,"a",6),t._uU(11,"Add"),t.qZA()()(),t.TgZ(12,"div",7)(13,"div",8)(14,"div",9)(15,"div",10)(16,"div",11)(17,"div",12)(18,"div",13)(19,"div",14)(20,"div",15)(21,"input",16),t.NdJ("ngModelChange",function(a){return n.serachText2=a})("ngModelChange",function(){return n.getRecivedNotification()}),t.qZA(),t.TgZ(22,"div",17)(23,"button",18),t._UZ(24,"i",19),t.qZA()()()()(),t.TgZ(25,"div",20)(26,"div",21),t._UZ(27,"input",22),t.TgZ(28,"span",23),t.NdJ("click",function(a){return n.openCalendar(a)}),t._UZ(29,"i",24),t.qZA()()()()()(),t.TgZ(30,"div",25)(31,"table",26)(32,"thead")(33,"tr")(34,"th"),t._uU(35,"SN"),t.qZA(),t.TgZ(36,"th"),t._uU(37,"Title"),t.qZA(),t.TgZ(38,"th"),t._uU(39,"Description"),t.qZA(),t.TgZ(40,"th"),t._uU(41,"Date"),t.qZA(),t.TgZ(42,"th"),t._uU(43,"\xa0"),t.qZA()()(),t.TgZ(44,"tbody"),t.YNc(45,N,18,4,"tr",27),t.qZA()()()(),t.TgZ(46,"div",28)(47,"div",10)(48,"div",11)(49,"div",12)(50,"div",13)(51,"div",14)(52,"div",15)(53,"input",16),t.NdJ("ngModelChange",function(a){return n.serachText=a})("ngModelChange",function(){return n.getSentNotification()}),t.qZA(),t.TgZ(54,"div",17)(55,"button",18),t._UZ(56,"i",19),t.qZA()()()()(),t.TgZ(57,"div",20)(58,"div",21),t._UZ(59,"input",29),t.TgZ(60,"span",23),t.NdJ("click",function(a){return n.openCalendarNotify(a)}),t._UZ(61,"i",24),t.qZA()()()()(),t.TgZ(62,"div",30)(63,"a",31),t._UZ(64,"i",32),t._uU(65," Add Notification"),t.qZA()()(),t.TgZ(66,"div",25)(67,"table",26)(68,"thead")(69,"tr")(70,"th"),t._uU(71,"SN"),t.qZA(),t.TgZ(72,"th"),t._uU(73,"Title"),t.qZA(),t.TgZ(74,"th"),t._uU(75,"Description"),t.qZA(),t.TgZ(76,"th"),t._uU(77,"Date"),t.qZA(),t.TgZ(78,"th"),t._uU(79,"\xa0"),t.qZA()()(),t.TgZ(80,"tbody"),t.YNc(81,_,12,4,"tr",33),t.qZA()()()()()()()(),t.TgZ(82,"div",34)(83,"div",35)(84,"div",36)(85,"div",37)(86,"div",38)(87,"div",39)(88,"h1"),t._uU(89,"Add Notification"),t.qZA(),t._UZ(90,"button",40),t.qZA(),t.TgZ(91,"div",14)(92,"label"),t._uU(93,"Select User Level"),t.qZA(),t.TgZ(94,"ng-multiselect-dropdown",41),t.NdJ("ngModelChange",function(a){return n.selectedItems=a}),t.qZA()(),t.TgZ(95,"div",14)(96,"label"),t._uU(97,"Title"),t.qZA(),t.TgZ(98,"input",42),t.NdJ("ngModelChange",function(a){return n.notificationTitle=a}),t.qZA()(),t.TgZ(99,"div",14)(100,"label"),t._uU(101,"Description"),t.qZA(),t.TgZ(102,"textarea",43),t.NdJ("ngModelChange",function(a){return n.notificationDescription=a}),t.qZA()(),t.TgZ(103,"div",44)(104,"button",45),t._uU(105,"Cancel"),t.qZA(),t.TgZ(106,"button",46),t.NdJ("click",function(){return n.addNotification()}),t._uU(107,"Save"),t.qZA()()()()()()()),2&i&&(t.xp6(21),t.Q6J("ngModel",n.serachText2),t.xp6(24),t.Q6J("ngForOf",n.recivedNotifications),t.xp6(8),t.Q6J("ngModel",n.serachText),t.xp6(28),t.Q6J("ngForOf",n.sentNotifications),t.xp6(13),t.Q6J("placeholder","Select User Type")("settings",n.dropdownSettings)("data",n.dropdownList)("ngModel",n.selectedItems),t.xp6(4),t.Q6J("ngModel",n.notificationTitle),t.xp6(4),t.Q6J("ngModel",n.notificationDescription),t.xp6(4),t.Q6J("disabled",!n.selectedItems.length||!n.notificationTitle||!n.notificationDescription))},dependencies:[g.sg,p.Fj,p.JJ,p.On,v.O],styles:[".multiselect-dropdown .dropdown-btn{border:none!important}  .multiselect-dropdown .dropdown-btn .selected-item-container .selected-item{border:1px solid #3e916c!important;background:#3e916c!important;color:#fff!important;max-width:inherit!important}  .multiselect-item-checkbox input[type=checkbox]+div:before{color:#3e916c!important;border:2px solid #3e916c!important}  .multiselect-item-checkbox input[type=checkbox]:checked+div:before{background:#3e916c!important}"]})}return o})()}];let A=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#i=this.\u0275inj=t.cJS({imports:[h.Bz.forChild(T),h.Bz]})}return o})(),w=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#i=this.\u0275inj=t.cJS({providers:[m],imports:[A,g.ez,p.u5,v.Z]})}return o})()}}]);